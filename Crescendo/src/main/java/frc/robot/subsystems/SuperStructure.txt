package frc.robot.subsystems;

import edu.wpi.first.math.geometry.Rotation2d;
import edu.wpi.first.wpilibj2.command.Command;
import edu.wpi.first.wpilibj2.command.SubsystemBase;
import frc.robot.subsystems.Elevator.ElevatorState;
import frc.robot.subsystems.Hood.HoodState;
import frc.robot.subsystems.HoodWrist.HoodWristState;
import frc.robot.subsystems.Indexer.IndexerState;
import frc.robot.subsystems.Joint.JointState;
import frc.robot.subsystems.Toaster.ToasterState;
import frc.robot.subsystems.IndexerWrist.IndexerWristState;

public class SuperStructure extends SubsystemBase {
  //SUPER STRUCTURE INSTANCE
  public static SuperStructure m_superStructure = new SuperStructure();

  public final Elevator m_elevator = Elevator.getInstance();
  public final Hood m_hood = Hood.getInstance();
  public final Indexer m_indexer = Indexer.getInstance();
  public final Toaster m_toaster = Toaster.getInstance();

  //WRISTS
  public final IndexerWrist m_indexerWrist = IndexerWrist.getInstance();
  public final HoodWrist m_hoodWrist = HoodWrist.getInstance();
  public final Joint m_joint = Joint.getInstance();


  private SuperStructure() {}

  public enum SuperStructureState{
    ZERO,
    GROUND_INTAKE,
    SOURCE,
    SPEAKER_SHOOT,
    AMP_SHOOT,
    TRAP
  }

  private static SuperStructure m_instance = new SuperStructure();

  public static SuperStructure getInstance(){
    return m_instance;
  }
  
  private SuperStructureState m_state = SuperStructureState.ZERO;

  
  public void zeroAll(){
    //WRISTS
    m_joint.setState(JointState.ZERO);
    m_indexerWrist.setState(IndexerWristState.ZERO);
    m_hoodWrist.setState(HoodWristState.ZERO);

    //REGULAR SUBSYSTEM
    m_elevator.setState(ElevatorState.ZERO);
  }

  public void goToElevatorPosition(Rotation2d jointSetpoint, Double elevatorSetpoint){
    m_joint.setSetpoint(jointSetpoint);
    m_elevator.setSetpoint(elevatorSetpoint);
  }

  public void setState(SuperStructureState newState) {
    m_state = newState;

    switch (m_state) {
      case ZERO:
        zeroAll();
        break;

      case GROUND_INTAKE:
        goToElevatorPosition(0,0);
        m_indexerWrist.setSetpoint(0);
        m_indexer.setState(IndexerState.ON);
        m_toaster.setState(ToasterState.INTAKE);
        m_hoodWrist.setState(ToasterState.ZERO);
        break;
    
      case SOURCE:
        goToElevatorPosition(0,0);
        m_hood.setState(HoodState.OFF);
        m_toaster.setState(ToasterState.INTAKE);
        break;
      
      case SPEAKER_SHOOT:
        jointGoToSetpoint(null);
        m_toaster.setState(ToasterState.SPEAKER_SHOOT);
        m_hood.setState(HoodState.OFF);
        break;
        
      case AMP_SHOOT:
        jointGoToSetpoint(null);
        elevatorGoToSetpoint(null);
        hoodGoToSetpoint(null);
        m_hood.setState(HoodState.ON);
        m_toaster.setState(ToasterState.AMP_SHOOT);

      case TRAP:
        jointGoToSetpoint(null);
        elevatorGoToSetpoint(null);
        
        break;
    }
  }

  @Override
  public void simulationPeriodic() {
    // This method will be called once per scheduler run during simulation
  }
}
